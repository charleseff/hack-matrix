#!/bin/bash
# Platform-aware Swift build wrapper
# Automatically uses .build-macos or .build-linux based on platform

set -e

if [[ "$(uname)" == "Darwin" ]]; then
    BUILD_PATH=".build-macos"

    # Build SPM (headless) version
    swift build --build-path "$BUILD_PATH" "$@"

    # Also build Xcode GUI app (needed for visual mode)
    echo "Building Xcode GUI app..."
    xcodebuild -scheme HackMatrix -configuration Debug build -quiet
else
    BUILD_PATH=".build-linux"
    exec swift build --build-path "$BUILD_PATH" "$@"
fi
